<svg version="1.1" width="600" height="120" xmlns="http://www.w3.org/2000/svg" >
<defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" /></marker></defs>

<path d="M 20 65 h 560 v -20 h -560 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 40 45 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 120 45 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 140 45 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 220 45 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 240 45 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 300 45 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 320 45 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 460 45 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>

<text x="26" y="60" style="font-size:13px;font-family:'Arial'">X</text>
<text x="126" y="60" style="font-size:13px;font-family:'Arial'">X</text>
<text x="226" y="60" style="font-size:13px;font-family:'Arial'">X</text>
<text x="306" y="60" style="font-size:13px;font-family:'Arial'">X</text>

<text x="60" y="60" style="font-size:13px;font-family:'Microsoft Yahei UI'">66字节</text>
<text x="160" y="60" style="font-size:13px;font-family:'Microsoft Yahei UI'">64字节</text>
<text x="260" y="60" style="font-size:13px;font-family:'Microsoft Yahei UI'">4字节</text>
<text x="360" y="60" style="font-size:13px;font-family:'Microsoft Yahei UI'">可变长度</text>
<text x="500" y="60" style="font-size:13px;font-family:'Microsoft Yahei UI'">可变长度</text>

<path d="M 40 68 v 5 a 5 5 0 0 0 5 5 h 30 a 5 5 0 0 1 5 5 a 5 5 0 0 1 5 -5 h 30 a 5 5 0 0 0 5 -5 v -5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 140 42 v -5 a 5 5 0 0 1 5 -5 h 30 a 5 5 0 0 0 5 -5 a 5 5 0 0 0 5 5 h 30 a 5 5 0 0 1 5 5 v 5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 240 68 v 5 a 5 5 0 0 0 5 5 h 20 a 5 5 0 0 1 5 5 a 5 5 0 0 1 5 -5 h 20 a 5 5 0 0 0 5 -5 v -5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 320 42 v -5 a 5 5 0 0 1 5 -5 h 60 a 5 5 0 0 0 5 -5 a 5 5 0 0 0 5 5 h 60 a 5 5 0 0 1 5 5 v 5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 460 68 v 5 a 5 5 0 0 0 5 5 h 50 a 5 5 0 0 1 5 5 a 5 5 0 0 1 5 -5 h 50 a 5 5 0 0 0 5 -5 v -5" stroke="#000000" stroke-width="1" fill="none"/>

<text x="30" y="100" style="font-size:13px;font-family:'Microsoft Yahei'">1.发送者的公钥</text>
<text x="210" y="100" style="font-size:13px;font-family:'Microsoft Yahei'">3.客户端版本信息</text>
<text x="470" y="100" style="font-size:13px;font-family:'Microsoft Yahei'">5.用户的屏幕信息</text>
<text x="120" y="20" style="font-size:13px;font-family:'Microsoft Yahei'">2.会话的Session ID</text>
<text x="350" y="20" style="font-size:13px;font-family:'Microsoft Yahei'">4.用户的提问</text>

<path d="M 30 20 V 33" stroke="#000000" stroke-width="1" fill="none" marker-end="url(#arrowhead)"/>
<text x="10" y="15" style="font-size:13px;font-family:'Microsoft Yahei'">一字节的分隔符</text>

<!--
<text x="130" y="60" style="font-size:13px;font-family:'Microsoft Yahei'">接收者的公钥</text>
<text x="255" y="60" style="font-size:13px;font-family:'Microsoft Yahei'">加密后的数据包，包含真正的数据，可能也有随机数据</text>
<text x="224" y="58" style="font-size:13px;font-family:'Arial'">@</text>

<text x="210" y="15" style="font-size:13px;font-family:'Microsoft Yahei'">分隔符</text>


<path d="M 20 70 v 5 a 5 5 0 0 0 5 5 h 40 a 5 5 0 0 1 5 5 a 5 5 0 0 1 5 -5 h 40 a 5 5 0 0 0 5 -5 v -5" stroke="#000000" stroke-width="1" fill="none"/>
<text x="145" y="20" style="font-size:13px;font-family:'Microsoft Yahei'">44个字节</text>
<text x="54" y="100" style="font-size:13px;font-family:'Microsoft Yahei'">44个字节</text>
<text x="340" y="20" style="font-size:13px;font-family:'Microsoft Yahei'">经过base64编码后的消息包</text>
<path d="M 120 40 v -5 a 5 5 0 0 1 5 -5 h 40 a 5 5 0 0 0 5 -5 a 5 5 0 0 0 5 5 h 40 a 5 5 0 0 1 5 5 v 5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 240 40 v -5 a 5 5 0 0 1 5 -5 h 160 a 5 5 0 0 0 5 -5 a 5 5 0 0 0 5 5 h 160 a 5 5 0 0 1 5 5 v 5" stroke="#000000" stroke-width="1" fill="none"/>

<path d="M 240 70 v 20 L 20 125 V 148" stroke="#000000" stroke-width="1" stroke-dasharray="3,3" fill="none" marker-end="url(#arrowhead)"  />
<path d="M 580 70 V 148" stroke="#000000" stroke-width="1"  stroke-dasharray="3,3" fill="none" marker-end="url(#arrowhead)"  />

<path d="M 20 180 h 560 v -20 h -560 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 120 160 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 220 160 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 280 160 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 340 160 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 400 160 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<rect x="440" y="160" width="120" height="20" style="fill:#DDDDDD;stroke:#0000FF;stroke-width:1"/>

<text x="45" y="175" style="font-size:13px;font-family:'Microsoft Yahei'">32个字节</text>
<text x="145" y="175" style="font-size:13px;font-family:'Microsoft Yahei'">32个字节</text>
<text x="227" y="175" style="font-size:13px;font-family:'Microsoft Yahei'">4个字节</text>
<text x="287" y="175" style="font-size:13px;font-family:'Microsoft Yahei'">4个字节</text>
<text x="350" y="175" style="font-size:13px;font-family:'Microsoft Yahei'">CRC32</text>

<path d="M 20 185 v 5 a 5 5 0 0 0 5 5 h 40 a 5 5 0 0 1 5 5 a 5 5 0 0 1 5 -5 h 40 a 5 5 0 0 0 5 -5 v -5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 120 155 v -5 a 5 5 0 0 1 5 -5 h 40 a 5 5 0 0 0 5 -5 a 5 5 0 0 0 5 5 h 40 a 5 5 0 0 1 5 5 v 5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 280 155 v -5 a 5 5 0 0 1 5 -5 h 20 a 5 5 0 0 0 5 -5 a 5 5 0 0 0 5 5 h 20 a 5 5 0 0 1 5 5 v 5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 440 155 v -5 a 5 5 0 0 1 5 -5 h 50 a 5 5 0 0 0 5 -5 a 5 5 0 0 0 5 5 h 50 a 5 5 0 0 1 5 5 v 5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 400 185 v 5 a 5 5 0 0 0 5 5 h 10 a 5 5 0 0 1 5 5 a 5 5 0 0 1 5 -5 h 10 a 5 5 0 0 0 5 -5 v -5" stroke="#000000" stroke-width="1" fill="none"/>
<path d="M 310 135 v -28 H 500 V 128" stroke="#000000" stroke-width="1" fill="none" marker-end="url(#arrowhead)"  />

<text x="43" y="215" style="font-size:13px;font-family:'Microsoft Yahei'">会话密钥</text>
<text x="445" y="175" style="font-size:13px;font-family:'Microsoft Yahei'">n字节的真正的数据</text>
<text x="292" y="100" style="font-size:13px;font-family:'Microsoft Yahei'">真正数据的长度，按小端格式存储</text>
<text x="100" y="135" style="font-size:13px;font-family:'Microsoft Yahei'">加密后的SHA256的哈希值</text>
<path d="M 220 260 h 80 v -20 h -80 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 240 240 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 260 240 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>
<path d="M 280 240 v 20" stroke="#0000FF" stroke-width="1" fill="none"/>

<path d="M 220 185 V 228" stroke="#000000" stroke-width="1"  stroke-dasharray="3,3" fill="none" marker-end="url(#arrowhead)"  />
<path d="M 280 185 v 20 L 300 218 V 228" stroke="#000000" stroke-width="1"  stroke-dasharray="3,3" fill="none" marker-end="url(#arrowhead)"  />

<text x="226" y="255" style="font-size:13px;font-family:'Arial'">V</text>
<text x="246" y="255" style="font-size:13px;font-family:'Arial'">T</text>
<text x="263" y="255" style="font-size:13px;font-family:'Arial'">29</text>
<text x="286" y="255" style="font-size:13px;font-family:'Arial'">X</text>

<text x="226" y="235" style="font-size:13px;font-family:'Arial'">0</text>
<text x="246" y="235" style="font-size:13px;font-family:'Arial'">1</text>
<text x="266" y="235" style="font-size:13px;font-family:'Arial'">2</text>
<text x="286" y="235" style="font-size:13px;font-family:'Arial'">3</text>

<path d="M 120 280 H 230 V 272" stroke="#000000" stroke-width="1" fill="none" marker-end="url(#arrowhead)"  />
<path d="M 30 290 H 250 V 272" stroke="#000000" stroke-width="1" fill="none" marker-end="url(#arrowhead)"  />
<path d="M 270 262 V 280 H 420 V 213" stroke="#000000" stroke-width="1" fill="none" marker-end="url(#arrowhead)"  />
<path d="M 580 290 H 290 V 272" stroke="#000000" stroke-width="1" fill="none" marker-end="url(#arrowhead)"  />
<text x="425" y="250" style="font-size:13px;font-family:'Microsoft Yahei'">偏移量 : 随机产生</text>
<text x="120" y="275" style="font-size:13px;font-family:'Microsoft Yahei'">版本号</text>
<text x="30" y="285" style="font-size:13px;font-family:'Microsoft Yahei'">数据的类型</text>
<text x="460" y="285" style="font-size:13px;font-family:'Microsoft Yahei'">保留，目前没有使用</text>
-->
</svg>
